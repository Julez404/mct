/*
Author: Julian Linn
MCU: ATMEGA328P
PINOUT:
---------------------------------------------------------------------------------------------------------------
Dir	Function		Pinning			Description
---------------------------------------------------------------------------------------------------------------
Out LED1			PORTD(6)		LED 
---------------------------------------------------------------------------------------------------------------*/

//-------------------------------------------------------------
// Defines
//-------------------------------------------------------------

#define F_CPU 16000000

//-------------------------------------------------------------
// Includes
//-------------------------------------------------------------

#include <avr/io.h>
#include <avr/interrupt.h>
#include <util/delay.h>
#include <stdbool.h>

//-------------------------------------------------------------
// Declarations
//-------------------------------------------------------------


//-------------------------------------------------------------
// Function Prototypes
//-------------------------------------------------------------

void initPort(void);
void initInterrupt(void);



//-------------------------------------------------------------
// Variables
//-------------------------------------------------------------

volatile uint8_t toggleLED = 0;


//-------------------------------------------------------------
// Main
//-------------------------------------------------------------

int main(void)
{
	initPort();
	initInterrupt();

	while (1)
	{
		if (toggleLED>100)
		{
			PORTD ^= (1 << 6);
			toggleLED=0;
		}
	}
}

//-------------------------------------------------------------
// Handlers
//-------------------------------------------------------------

//-------------------------------------------------------------
// Interrupt handler
//-------------------------------------------------------------
//Stop / Lock Interrupt



ISR(TIMER2_OVF_vect)
{
	toggleLED ++;
}

//-------------------------------------------------------------
// Other functions
//-------------------------------------------------------------

void initPort(void)
{
	DDRB = 0;
	PORTB = 0xFF;
	DDRD = 0b11000000;
	PORTD = 0b00111111;
}

void initInterrupt(void)
{
	//TMR0 Implementation
	TCCR2A = 0;											// No Compare Operation
	TCCR2B |= (1 << CS22) | (1 << CS21) | (1 << CS20);	// Prescaler select
	TIMSK2 |= (1 << 0);									// Overflow Interrupt enable
							// Interrupt enable
	
	//Interrupt Enable
	sei();
}

